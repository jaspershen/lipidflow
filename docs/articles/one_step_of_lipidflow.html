<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example of lipid absolute quantification • lipidflow</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Example of lipid absolute quantification">
<meta property="og:description" content="lipidflow">
<meta property="og:image" content="https://jaspershen.github.io/lipidflow/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-000000-01"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-000000-01');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lipidflow</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Under development">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help documents
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Brief introduction</li>
    <li>
      <a href="../articles/lipidflow.html">Brief introduction of lipidflow</a>
    </li>
    <li>
      <a href="../articles/overview_of_lipidflow.html">Overview of workflow of lipidflow</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Absolute quantification of lipids</li>
    <li>
      <a href="../articles/get_is_retention_time.html">Step 1: get internal standard retention time</a>
    </li>
    <li>
      <a href="../articles/is_relative_quantification.html">Step 2: get relative quantification data</a>
    </li>
    <li>
      <a href="../articles/absolute_quantification.html">Step 3: get absolute quantification data</a>
    </li>
    <li>
      <a href="../articles/output_result.html">Step 4: output and organize results</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/one_step_of_lipidflow.html">One function to all steps</a>
    </li>
    <li class="dropdown-header">Other tools in lipidflow</li>
    <li>
      <a href="../articles/lipidflow.html">Other tools in lipidflow</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/contact_us.html">Contact us</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/lipidflow.html">Get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaspershen/lipidflow/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/JasperShen1990">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="one_step_of_lipidflow_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example of lipid absolute quantification</h1>
                        <h4 class="author">Xiaotao Shen PhD (<a href="https://www.shenxt.info/" class="uri">https://www.shenxt.info/</a>)</h4>
                                    <h4 class="author">Chuchu wang PhD</h4>
            <address class="author_afil">
      School of Medicine, Stanford University<br><h4 class="date">Created on 2021-02-09 and updated on 2021-03-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jaspershen/lipidflow/blob/master/vignettes/one_step_of_lipidflow.Rmd"><code>vignettes/one_step_of_lipidflow.Rmd</code></a></small>
      <div class="hidden name"><code>one_step_of_lipidflow.Rmd</code></div>

    </address>
</div>

    
    
<hr>
<div id="demo-data-to-show-how-to-use-lipidflow" class="section level1">
<h1 class="hasAnchor">
<a href="#demo-data-to-show-how-to-use-lipidflow" class="anchor"></a><strong>Demo data to show how to use <code>lipidflow</code></strong>
</h1>
<p>Here we use the demo data in <code>lipidflow</code> to show how to use it for lipid absolute quantification.</p>
<div id="organize-the-demo-data" class="section level2">
<h2 class="hasAnchor">
<a href="#organize-the-demo-data" class="anchor"></a><strong>Organize the demo data</strong>
</h2>
<p>First, we need to get the demo dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jaspershen/lipidflow">lipidflow</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">pos_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"POS"</span>, package <span class="op">=</span> <span class="st">"lipidflow"</span><span class="op">)</span>
<span class="va">neg_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"NEG"</span>, package <span class="op">=</span> <span class="st">"lipidflow"</span><span class="op">)</span>
<span class="va">path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">"example"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">pos_data</span>, to <span class="op">=</span> <span class="va">path</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">neg_data</span>, to <span class="op">=</span> <span class="va">path</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Now there will be a <code>example</code> folder in your work directory. And in the <code>example</code> folder, there are two folders: <code>POS</code> and <code>NEG</code>. The are two groups for each mode: “D25” and “M19”. And each group has two repeats.</p>
<p><img src="../man/figures/figure_3.png"></p>
<p>Next, we should set the match list between internal standards and lipid class.</p>
<ul>
<li>Positive mode:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">match_item_pos</span> <span class="op">=</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"Cer"</span> <span class="op">=</span> <span class="st">"d18:1 (d7)-15:0 Cer"</span>,
    <span class="st">"ChE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"18:1(d7) Chol Ester"</span>, <span class="st">"Cholesterol (d7)"</span><span class="op">)</span>,
    <span class="st">"Chol"</span> <span class="op">=</span> <span class="st">"Cholesterol (d7)"</span>,
    <span class="st">"DG"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) DAG"</span>,
    <span class="st">"LPC"</span> <span class="op">=</span> <span class="st">"18:1(d7) Lyso PC"</span>,
    <span class="st">"LPE"</span> <span class="op">=</span> <span class="st">"18:1(d7) Lyso PE"</span>,
    <span class="st">"MG"</span> <span class="op">=</span> <span class="st">"18:1 (d7) MG"</span>,
    <span class="st">"PA"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PA (Na Salt)"</span>,
    <span class="st">"PC"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PC"</span>,
    <span class="st">"PE"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PE"</span>,
    <span class="st">"PG"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PG (Na Salt)"</span>,
    <span class="st">"PI"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PI (NH4 Salt)"</span>,
    <span class="st">"PPE"</span> <span class="op">=</span> <span class="st">"C18(Plasm)-18:1(d9) PE"</span>,
    <span class="st">"PS"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PS (Na Salt)"</span>,
    <span class="st">"SM"</span> <span class="op">=</span> <span class="st">"d18:1-18:1(d9) SM"</span>,
    <span class="st">"TG"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7)-15:0 TAG"</span>
  <span class="op">)</span></code></pre></div>
<ul>
<li>Negative mode:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">match_item_neg</span> <span class="op">=</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">"Cer"</span> <span class="op">=</span> <span class="st">"d18:1 (d7)-15:0 Cer"</span>,
    <span class="st">"Chol"</span> <span class="op">=</span> <span class="st">"Cholesterol (d7)"</span>,
    <span class="st">"ChE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"18:1(d7) Chol Ester"</span>, <span class="st">"Cholesterol (d7)"</span><span class="op">)</span>,
    <span class="st">"LPC"</span> <span class="op">=</span> <span class="st">"18:1(d7) Lyso PC"</span>,
    <span class="st">"LPE"</span> <span class="op">=</span> <span class="st">"18:1(d7) Lyso PE"</span>,
    <span class="st">"PC"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PC"</span>,
    <span class="st">"PE"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PE"</span>,
    <span class="st">"PG"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PG (Na Salt)"</span>,
    <span class="st">"PI"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PI (NH4 Salt)"</span>,
    <span class="st">"PPE"</span> <span class="op">=</span> <span class="st">"C18(Plasm)-18:1(d9) PE"</span>,
    <span class="st">"PS"</span> <span class="op">=</span> <span class="st">"15:0-18:1(d7) PS (Na Salt)"</span>,
    <span class="st">"SM"</span> <span class="op">=</span> <span class="st">"d18:1-18:1(d9) SM"</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="run-get_lipid_absolute_quantification-function" class="section level2">
<h2 class="hasAnchor">
<a href="#run-get_lipid_absolute_quantification-function" class="anchor"></a><strong>Run <code>get_lipid_absolute_quantification()</code> function</strong>
</h2>
<p>Then we run <code><a href="../reference/get_lipid_absolute_quantification.html">get_lipid_absolute_quantification()</a></code> function. Please note that <code>path</code> need to set as <code>example</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_lipid_absolute_quantification.html">get_lipid_absolute_quantification</a></span><span class="op">(</span>
  path <span class="op">=</span> <span class="st">"example"</span>,
  is_info_name_pos <span class="op">=</span> <span class="st">"IS_information.xlsx"</span>,
  is_info_name_neg <span class="op">=</span> <span class="st">"IS_information.xlsx"</span>,
  use_manual_is_info <span class="op">=</span> <span class="cn">FALSE</span>,
  lipid_annotation_table_pos <span class="op">=</span> <span class="st">"lipid_annotation_table_pos.xlsx"</span>,
  lipid_annotation_table_neg <span class="op">=</span> <span class="st">"lipid_annotation_table_neg.xlsx"</span>,
  output_eic <span class="op">=</span> <span class="cn">TRUE</span>,
  ppm <span class="op">=</span> <span class="fl">40</span>,
  rt.tolerance <span class="op">=</span> <span class="fl">180</span>,
  threads <span class="op">=</span> <span class="fl">3</span>,
  rerun <span class="op">=</span> <span class="cn">FALSE</span>,
  which_group_for_rt_confirm <span class="op">=</span> <span class="st">"D25"</span>,
  match_item_pos <span class="op">=</span> <span class="va">match_item_pos</span>,
  match_item_neg <span class="op">=</span> <span class="va">match_item_neg</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="output-result" class="section level1">
<h1 class="hasAnchor">
<a href="#output-result" class="anchor"></a><strong>Output result</strong>
</h1>
<p>Most of the results are outputted in the <code>example/Result</code>, some results are in <code>example/POS</code> and <code>example/NEG</code>.</p>
<div id="information-of-internal-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#information-of-internal-standards" class="anchor"></a><strong>Information of internal standards</strong>
</h2>
<p>Here we set <code>which_group_for_rt_confirm</code> as “D25”, so this group samples will be used to extract internal standards and get the information of all internal standards.</p>
<p>The retention times of all internal standards are generated automatically, and outputted as <code>IS_info_pos.xlsx</code> in “example/POS” and <code>IS_info_neg.xlsx</code> in “example/NEG”, respectively.</p>
<p><img src="../man/figures/figure5.png" alt="“IS_info_neg.xlsx”"> We can see that <code>lipidflow</code> added the <code>rt_neg_second</code>, <code>rt_neg_min</code>, <code>adduct_neg</code> and <code>mz_neg</code> in the <code>IS_info_new.xlsx</code>. If there are no good EICs, no information for these internal standards.</p>
<p>Sometimes the information of internal standards maybe not correct, so you can open the EICs of each internal standard and then check the RTs and then put correct information in your IS information table. The EICs for each internal standard is in the <code>example/POS/Result/peak_shape</code> folder.</p>
<p><img src="../man/figures/figure6.png"></p>
<p>One example is like below figure shows:</p>
<p>This is the EIC of <code>15_0-18_1(d7) PA (Na Salt)</code> with <code>M+H</code>. We can see that this internal <code>15_0-18_1(d7) PA (Na Salt)</code> has good peak shape and the retention time is around 800 second.</p>
<p>If you find information of some internal standards are not correct, you can put the right information in <code>IS_info_new.xlsx</code> in <code>positive and negative</code>POS<code>and</code>NEG<code>folders, respectively. And then rerun the</code>get_lipid_absolute_quantification()<code>function, and set</code>is_info_name_pos<code>and</code>is_info_name_neg<code>as</code>IS_info_new.xlsx<code>, and</code>use_manual_is_info<code>as</code>TRUE<code>, then</code>lipidflow` will use the modified information table for next processing.</p>
</div>
<div id="final-results-for-absolute-quantification-of-lipids" class="section level2">
<h2 class="hasAnchor">
<a href="#final-results-for-absolute-quantification-of-lipids" class="anchor"></a><strong>Final results for absolute quantification of lipids</strong>
</h2>
<p>All the results for absolute quantification of lipids are in <code>example/Result</code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xiaotao Shen, Chuchu Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '21ff2860978c5d2ceb7d4150364070ff',
    indexName: 'lipidflow',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
